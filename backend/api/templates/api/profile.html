{% extends 'api/base.html' %}

{% block content %}
{% if user.is_staff %}
<div class="row justify-content-center mt-4">
    <div class="col-lg-8 col-md-10">
        <div class="profile-card mb-4" style="background:#f3eaff; border:2px solid #a084e8; display:flex; align-items:center; gap:2.5rem;">
            <div class="text-center" style="flex:0 0 160px;">
                <div class="profile-avatar mb-3" style="background:#a084e8;color:#fff;width:110px;height:110px;font-size:3.5rem;">
                    <i class="fas fa-user-tie"></i>
                </div>
            </div>
            <div style="flex:1;">
                <div class="d-flex align-items-center justify-content-between mb-2">
                    <div>
                        <h2 class="mb-0">{{ user.get_full_name|default:user.username }}</h2>
                        <div class="text-muted">{{ user.email }}</div>
                    </div>
                    <span class="badge bg-secondary fs-6" style="height:2.1em;display:flex;align-items:center;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</span>
                </div>
                <div class="mb-2"><b>–û—Ç–¥–µ–ª:</b> {{ profile.department|default:'‚Äî' }}</div>
                <div class="mb-2"><b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> {{ profile.phone|default:'‚Äî' }}</div>
                <div class="mb-2"><b>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</b> {{ profile.birth_date|date:'d.m.Y'|default:'‚Äî' }}</div>
                <div class="mb-2"><b>–ë–∞–ª–∞–Ω—Å:</b> {{ profile.balance|default:'0.00' }} ‚ÇΩ</div>
                <div class="d-flex gap-2 mt-3">
                    <a href="mailto:{{ user.email }}" class="btn btn-outline-primary"><i class="fas fa-envelope me-1"></i>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ</a>
                    <a href="#" class="btn btn-outline-secondary"><i class="fas fa-file-signature me-1"></i>–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å—å</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="row">
    <div class="col-md-4">
        <div class="profile-card text-center">
            <div class="profile-avatar mb-2">
                <i class="fas fa-user-circle"></i>
            </div>
            <h2 class="mb-1">{{ user.username }}</h2>
            <div class="mb-2 text-muted">{{ user.email }}</div>
            <div class="profile-balance mb-3">–ë–∞–ª–∞–Ω—Å: {{ profile.balance|default:"0.00" }} ‚ÇΩ</div>
            <a href="#" class="btn profile-btn w-100 mb-2">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
            <a href="#" class="btn btn-outline-secondary w-100">üîë –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a>
        </div>
    </div>
    <div class="col-md-8">
        <div class="profile-card">
            <div class="profile-tabs">
                <button class="profile-tab active" type="button">–í—Å–µ–≥–æ –±–∏–ª–µ—Ç–æ–≤</button>
                <button class="profile-tab" type="button">–ê–∫—Ç–∏–≤–Ω—ã–µ –±–∏–ª–µ—Ç—ã</button>
                <button class="profile-tab" type="button">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏</button>
            </div>
            <div class="profile-stats-content" style="display:block;">
                <h4>–í—Å–µ–≥–æ –±–∏–ª–µ—Ç–æ–≤: {{ tickets.count }}</h4>
            </div>
            <div class="profile-stats-content" style="display:none;">
                <h4>–ê–∫—Ç–∏–≤–Ω—ã–µ –±–∏–ª–µ—Ç—ã: {{ tickets.active.count }}</h4>
            </div>
            <div class="profile-stats-content" style="display:none;">
                <h4>–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏: {{ tickets.completed.count }}</h4>
            </div>
        </div>
        <div class="profile-card">
            <h4 class="mb-3">–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h4>
            <form method="post">
                {% csrf_token %}
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="id_first_name" class="form-label">–ò–º—è:</label>
                        {{ user_form.first_name }}
                    </div>
                    <div class="col-md-6">
                        <label for="id_last_name" class="form-label">–§–∞–º–∏–ª–∏—è:</label>
                        {{ user_form.last_name }}
                    </div>
                </div>
                <div class="mb-3">
                    <label for="id_email" class="form-label">Email:</label>
                    {{ user_form.email }}
                </div>
                <div class="mb-3">
                    <label for="id_phone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                    {{ profile_form.phone }}
                </div>
                <div class="mb-3">
                    <label for="id_birth_date" class="form-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
                    {{ profile_form.birth_date }}
                </div>
                <button type="submit" class="btn profile-btn w-100">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </form>
        </div>
    </div>
</div>
{% endif %}
{% endblock %} 